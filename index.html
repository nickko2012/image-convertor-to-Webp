<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Image â†’ WEBP Converter â€” Step #1 Upload â†’ Step #2 Convert</title>
<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial;background:radial-gradient(circle at 20% 20%,#e8f0ff,#ffffff);color:#111827;display:flex;justify-content:center;padding:40px}
.container{max-width:900px;width:100%;}
header{text-align:left;margin-bottom:24px}
.step{background:#0a84ff;color:white;padding:4px 10px;border-radius:8px;font-size:12px;margin-right:6px}
.card{background:rgba(255,255,255,0.9);padding:20px;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);width:100%}
.grid{display:grid;grid-template-columns:1fr 360px;gap:20px}
.uploader{border:2px dashed #c7d2fe;border-radius:12px;padding:60px;text-align:center;cursor:pointer;transition:0.2s}
.uploader.drag{border-color:#0a84ff;background:rgba(10,132,255,0.05)}
.btn{background:#0a84ff;color:white;padding:10px 16px;border:none;border-radius:10px;cursor:pointer;font-weight:600;min-width:160px}
.controls{margin-top:20px;display:flex;flex-direction:column;gap:12px}
input[type=range]{width:100%;accent-color:#0a84ff}
.small{font-size:13px;color:#6b7280}
.result{margin-top:20px;display:none;text-align:left}
#reduction{font-weight:bold;color:#10b981}
#preview{max-width:320px;border-radius:10px;border:1px solid #e5e7eb}
</style>
</head>
<body>
<div class="container">
<header>
<h1>ðŸª„ Image â†’ WEBP Converter</h1>
<p>Step-by-step: <strong>Step 1</strong> upload â†’ <strong>Step 2</strong> convert â†’ download your optimized image.</p>
</header>
<div class="card grid">
<div>
<div id="uploader" class="uploader">
<span class="step">Step 1</span> Drop your image or click to upload<br>
<small class="small">(PNG, JPG, HEIC, GIF â€” Max 5 MB)</small>
<input id="fileInput" type="file" accept="image/*" hidden />
</div>
<div id="previewSection" style="display:none;margin-top:20px">
<img id="preview" />
<div class="controls">
<label>Quality: <span id="qualityLabel">80%</span></label>
<input id="quality" type="range" min="50" max="100" step="10" value="80" />
<label>Resize scale: <span id="scaleLabel">100%</span></label>
<input id="scale" type="range" min="10" max="200" step="10" value="100" />
<button id="convertBtn" class="btn">Step 2: Convert to WEBP</button>
</div>
<div id="result" class="result">
<p><strong>Converted!</strong> File size reduced by <span id="reduction">0%</span>.</p>
</div>
</div>
</div>
<div>
<h3>ðŸ’¡ Tips</h3>
<ul class="small">
<li>ðŸ“¸ Keep quality around 70â€“85% for best balance.</li>
<li>âš¡ Try scaling to 50â€“80% for faster web performance.</li>
<li>ðŸ’¾ Works locally in your browser. No uploads.</li>
</ul>
</div>
</div>
</div>
<script>
const uploader=document.getElementById('uploader'),fileInput=document.getElementById('fileInput'),preview=document.getElementById('preview'),previewSection=document.getElementById('previewSection'),quality=document.getElementById('quality'),scale=document.getElementById('scale'),qualityLabel=document.getElementById('qualityLabel'),scaleLabel=document.getElementById('scaleLabel'),convertBtn=document.getElementById('convertBtn'),result=document.getElementById('result'),reductionEl=document.getElementById('reduction');
let currentFile=null,currentImage=null,downloadUrl=null;

uploader.addEventListener('click',()=>fileInput.click());
;['dragenter','dragover'].forEach(evn=>uploader.addEventListener(evn,e=>{e.preventDefault();uploader.classList.add('drag')}));
;['dragleave','drop'].forEach(evn=>uploader.addEventListener(evn,e=>{e.preventDefault();uploader.classList.remove('drag')}));
uploader.addEventListener('drop',e=>{const f=e.dataTransfer.files[0];if(f)handleFile(f)});
fileInput.addEventListener('change',e=>{const f=e.target.files[0];if(f)handleFile(f)});

function handleFile(f){
 if(!f.type.startsWith('image/'))return alert('Please upload an image file.');
 if(f.size<1024)return alert('File too small (min 1 KB). Please choose a valid image.');
 if(f.size>5*1024*1024)return alert('File exceeds 5 MB. Please contact Admin if you need to upload larger files.');
 currentFile=f; const img=new Image(); img.onload=()=>{currentImage=img;preview.src=img.src;uploader.style.display='none';previewSection.style.display='block';}; img.src=URL.createObjectURL(f);
}

quality.addEventListener('input',()=>qualityLabel.textContent=quality.value+'%');
scale.addEventListener('input',()=>scaleLabel.textContent=scale.value+'%');

convertBtn.addEventListener('click',async()=>{
 if(!currentImage)return alert('Please upload an image first.');
 convertBtn.textContent='Processing...';
 const canvas=document.createElement('canvas');
 const targetW=currentImage.naturalWidth*(scale.value/100);
 const targetH=currentImage.naturalHeight*(scale.value/100);
 canvas.width=targetW;canvas.height=targetH;
 const ctx=canvas.getContext('2d');ctx.drawImage(currentImage,0,0,targetW,targetH);
 const blob=await new Promise(r=>canvas.toBlob(r,'image/webp',quality.value/100));
 if(!blob)return alert('Conversion failed.');
 const reduction=Math.round((1-blob.size/currentFile.size)*100);
 reductionEl.textContent=reduction+'%';
 result.style.display='block';
 if(downloadUrl)URL.revokeObjectURL(downloadUrl);
 downloadUrl=URL.createObjectURL(blob);
 convertBtn.textContent='Download';
 convertBtn.onclick=()=>{
 const a=document.createElement('a');
 a.href=downloadUrl;
 a.download='converted.webp';
 a.click();
 };
});
</script>
</body>
</html>
